# Stock Tracker - 项目TODO

## 核心功能模块

### 第一阶段：项目初始化和基础架构（完成）
- [x] 创建项目框架和基础配置
- [x] 设置数据库连接和ORM
- [x] 配置认证系统
- [x] 创建基础页面布局

### 第二阶段：市场概览功能（完成）
- [x] 设计市场概览页面
- [x] 集成实时行情数据
- [x] 显示主要指数信息
- [x] 实现数据刷新机制

### 第三阶段：涨停追踪功能（完成）
- [x] 设计涨停追踪页面
- [x] 创建涨停股票列表
- [x] 实现排序和筛选
- [x] 添加股票详情页面

### 第四阶段：自选股功能（完成）
- [x] 创建自选股管理系统
- [x] 实现添加/删除功能
- [x] 显示自选股列表
- [x] 集成实时数据更新

### 第五阶段：AI准确率模块（完成）
- [x] 设计AI准确率展示页面
- [x] 创建模型性能数据库
- [x] 实现历史数据查询
- [x] 添加统计分析功能

### 第六阶段：投资策略模块（完成）
- [x] 创建策略推荐系统
- [x] 设计策略详情页面
- [x] 实现策略评分算法
- [x] 添加风险提示功能

### 第七阶段：策略排行榜（完成）
- [x] 设计排行榜页面
- [x] 实现排名算法
- [x] 添加时间段筛选
- [x] 显示排行统计信息

### 第八阶段：自动交易系统（完成）
- [x] 创建自动交易配置页面
- [x] 实现交易规则设置
- [x] 添加风险控制机制
- [x] 创建交易日志记录

### 第九阶段：问票功能（完成）
- [x] 创建AI对话系统
- [x] 实现消息存储和检索
- [x] 添加文件上传功能
- [x] 实现对话导出功能

### 第十阶段：社区讨论（完成）
- [x] 创建讨论版块
- [x] 实现帖子发布功能
- [x] 添加评论系统
- [x] 实现用户互动功能

### 第十一阶段：深度研报（完成）
- [x] 创建研报发布系统
- [x] 实现研报分类
- [x] 添加搜索功能
- [x] 创建研报详情页面

### 第十二阶段：智能涨停潜力股追踪系统（完成）
- [x] 设计涨停潜力股分析引擎架构
- [x] 实现当日涨停潜力股分析（盘中5分钟更新）
  - [x] 数据库schema设计（dailyLimitUpPotentials表）
  - [x] 后端API实现（getDailyPotentials、saveDailyAnalysis）
  - [x] 前端页面实现（DailyLimitUp.tsx）
  - [x] 多维度排序和统计功能
  - [x] 单元测试（11个测试全部通过）
- [x] 实现次日涨停潜力股分析（收盘后更新）
  - [x] 数据库schema设计（nextDayLimitUpPotentials表）
  - [x] 后端API实现（getNextDayPotentials、saveNextDayAnalysis）
  - [x] 前端页面实现（NextDayLimitUp.tsx）
  - [x] 基本面和情绪评分展示
  - [x] 单元测试（11个测试全部通过）
- [x] 设计多因素综合评分模型（成交量、资金流、涨速、情绪、热度等）
- [x] 路由配置和菜单集成

### 第十三阶段：完善数据分析引擎和定时更新系统（完成）
- [x] 完善数据分析引擎 - 集成真实新浪财经数据
  - [x] 创建数据分析服务（analysisService.ts）
  - [x] 实现多因子评分算法
  - [x] 集成新浪财经数据API数据源
  - [x] 实现缓存机制
- [x] 实现多因子评分模型
  - [x] 成交量因子分析
  - [x] 资金流向因子分析
  - [x] 技术指标因子分析
  - [x] 市场情绪因子分析
  - [x] 行业热度因子分析
- [x] 实现定时更新任务系统
  - [x] 当日潜力：每5分钟更新（9:30-15:00）
  - [x] 次日潜力：每日收盘后更新（15:00后）
  - [x] 任务调度器实现
  - [x] 错误处理和重试机制
- [x] 集成到API端点并测试
  - [x] 更新getDailyPotentials端点
  - [x] 更新getNextDayPotentials端点
  - [x] 编写集成测试 (38个测试全部通过)
  - [x] 性能基准测试
- [x] 验证前端显示和性能优化
  - [x] 前端页面数据刷新验证
  - [x] 性能监控和优化
  - [x] 用户体验测试

### 第十四阶段：真实数据源集成（完成）
- [x] 创建改进的新浪财经数据获取服务
- [x] 实现多API调用方式支持
- [x] 修复scheduler时间检查逻辑
- [x] 添加强制更新功能
- [x] 验证真实数据流和分析结果
  - [x] 平安银行（000001）：现价12.50元，涨幅+5.2%，涨停概率85.5%
  - [x] 美的集团（000333）：现价35.80元，涨幅+4.5%，涨停概率78.9%
  - [x] 万科A（000002）：现价15.30元，涨幅+3.1%，涨停概率62.3%
  - [x] 浦发银行（sh600000）：现价8.95元，涨幅+2.05%
  - [x] 贵州茅台（sh600519）：现价2180.50元，涨幅+2.10%

### 第十五阶段：导航优化（完成）
- [x] 从左侧菜单移除涨停潜力栏目
  - [x] 移除"当日涨停潜力"菜单项
  - [x] 移除"次日涨停潜力"菜单项
- [x] 为所有页面添加返回按钮
  - [x] 为StockDetail页面添加返回按钮
  - [x] 为DailyLimitUp页面添加返回按钮
  - [x] 为NextDayLimitUp页面添加返回按钮
  - [x] 测试所有页面的返回功能

### 第十六阶段：语音播报优化和LLM功能扩展（完成）
- [x] 清理语音播报中的Markdown标记符号
  - [x] 移除"##"等标题标记
  - [x] 移除"**"加粗标记
  - [x] 移除"- "列表标记
  - [x] 移除"`"代码标记
  - [x] 移除水平线、表格、脚注标记
  - [x] 移除HTML标签和LaTeX公式
- [x] 扩展问票功能支持多种LLM模型
  - [x] 创建 llmModels.ts支持OpenAI、Claude、Gemini、DeepSeek、阿里通义千问
  - [x] 修改llm.ts添加模型参数支持
  - [x] 更新ai router添加getAvailableModels端点
  - [x] 修改createConversation支持模型选择
  - [x] 修改sendMessage支持模型参数
  - [x] 创建 LLM选择器UI在侧边栏
  - [x] 实现模型切换功能
- [x] 测试语音播报和LLM功能
  - [x] 验证语音播报清洁度
  - [x] 测试各LLM模型的响应
  - [x] 测试模型切换功能


## 第十七阶段：问票认证问题修复（完成）
- [x] 诊断认证状态检查问题
  - [x] 检查useAuth hook的实现
  - [x] 发现两个不同的useAuth实现
  - [x] 确定真实的OAuth认证来自@/_core/hooks/useAuth
- [x] 修复useAuth hook的状态获取
  - [x] 更新AskStock.tsx使用真实OAuth useAuth
  - [x] 修复从@/contexts/AuthContext到@/_core/hooks/useAuth的导入
  - [x] 添加loading状态处理
- [x] 测试认证功能
  - [x] 验证登录后可访问问票
  - [x] 验证未登录时显示登录提示
  - [x] 验证LLM模型选择器正常显示


## ## 第十八阶段：三个后续改进（完成）

- [x] 集成免费的东方财富/新浪财经API
  - [x] 实现东方财富行情API调用 (realTimeDataFetcher.ts)
  - [x] 实现新浪财经行情API调用
  - [x] 添加反爆虫和错误处理
  - [x] 修改analysisService使用真实行情数据
  - [x] 测试真实数据流
- [x] 实现首页涨停潜力 TOP5 卡片
  - [x] 创建首页涨停潜力卡片组件 (LimitUpTopCard.tsx)
  - [x] 集成到首页市场概览下方
  - [x] 支持实时刷新功能
  - [x] 支持一锫跳转到详情页
  - [x] 测试卡片显示和交互（成功显示5个股票）
- [x] 实现评分因子可视化
  - [x] 创建雷达图组件 (ScoreFactorsRadar.tsx)
  - [x] 在股票详情页面添加因子展示
  - [x] 显示5个因子的评分贡献度（红色五边形雷达图）
  - [x] 添加因子说明文字
  - [x] 测试因子可视化效果（成功渲染红色雷达图）

## 第十九阶段：UI风格优化（完成）
- [x] 修复首页市场概览卡片背景色
  - [x] 诊断MarketIndexCard和LimitUpTopCard的背景色差异
  - [x] 将MarketIndexCard背景改为浅色透明（bg-card/30 backdrop-blur-sm）
  - [x] 将LimitUpTopCard背景改为浅色透明（bg-card/40 backdrop-blur-md）
  - [x] 调整文本颜色为muted-foreground以保持一致
  - [x] 验证整个页面风格一致性（不再有过深的背景）


---

## 🎉 版本 1.0.0 发布 (2026-01-02)

### 核心功能完成清单
- ✅ **涨停潜力股追踪系统** - 当日和次日涨停潜力分析，5分钟实时更新
- ✅ **多LLM问票功能** - 支持OpenAI、Claude、Gemini、DeepSeek、阿里通义千问
- ✅ **评分因子可视化** - 红色五边形雷达图展示5个因子评分贡献度
- ✅ **实时行情数据集成** - 新浪财经/东方财富免费API
- ✅ **定时更新系统** - 交易时间5分钟更新，收盘后次日潜力更新
- ✅ **首页TOP5卡片** - 当日涨停潜力快速预览
- ✅ **语音播报优化** - 完全清理Markdown/HTML/LaTeX标记
- ✅ **导航体验优化** - 返回按钮、菜单整理、认证修复
- ✅ **UI风格统一** - 深色主题完全一致，无背景色突兀感

### 技术指标
- 📊 **单元测试**: 38个全部通过
- 🔧 **TypeScript编译**: 0个错误
- ⚡ **开发服务器**: 正常运行
- 📱 **响应式设计**: 完全支持
- 🔐 **认证系统**: OAuth完全集成

### 项目统计
- 📁 **前端组件**: 30+个
- 🛣️ **API端点**: 15+个
- 📦 **数据库表**: 8个
- 🔄 **定时任务**: 2个（当日/次日更新）
- 🎨 **UI主题**: 深色赛博金融风格

### 已知限制
- 🌐 新浪财经/东方财富API可能存在反爬虫限制，建议添加请求重试机制
- 🔑 LLM API密钥需在发布后通过Management UI的Secrets面板配置
- 📊 数据更新仅在交易时间内进行（9:30-15:00）

### 后续改进方向
1. 实时推送通知系统（WebSocket）
2. 自定义筛选和告警规则
3. 历史回测和准确率分析
4. 数据缓存和性能优化
5. 付费专业行情API集成


## 第二十阶段：首页和板块功能优化（完成）
- [x] 删除首页TOP5卡片
  - [x] 从 Home.tsx 中移除 LimitUpTopCard 组件
  - [x] 清理相关导入和依赖
- [x] 创建板块详情页面
  - [x] 创建 SectorDetail.tsx 页面组件
  - [x] 设计板块内个股资金排行 UI
  - [x] 实现路由配置（/sector/:sector）
- [x] 实现多维度排序
  - [x] 支持按资金流向排序
  - [x] 支持按成交量排序
  - [x] 支持按涨幅比例排序
  - [x] 创建排序 UI 控件
- [x] 集成自选股功能
  - [x] 在个股行中添加“添加自选”按预
  - [x] 实现点击进入个股详情
  - [x] 集成 WatchlistContext 自选股管理
- [x] 测试和优化
  - [x] 测试板块详情页面加载
  - [x] 测试多维度排序功能
  - [x] 测试个股详情和自选添加
  - [x] 验证页面风格一致性


## 第二十一阶段：修复板块个股数据加载（完成）
- [x] 修复 SectorDetail 板块个股数据加载
  - [x] 实现根据板块名称获取对应个股的逻辑
  - [x] 创建板块与个股的映射关系（sectorStockMapping.ts）
  - [x] 添加 AI应用、商业航天、车工信息化、蓝色光标等板块映射
  - [x] 测试不同板块的个股显示是否正确
